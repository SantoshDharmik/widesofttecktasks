<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Popup Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #addNotesBtn { padding: 10px 16px; font-size: 16px; }
    /* backdrop */
    .popup-backdrop {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.45);
      z-index: 9999;
    }
    .popup-backdrop.open { display: flex; }
    /* modal box */
    .popup-box {
      background: #fff;
      border-radius: 10px;
      padding: 18px;
      width: 420px;
      max-width: 92%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      position: relative;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      border: 0;
      background: #e74c3c;
      color: #fff;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <h2>Note Keeper — Test</h2>
  <button id="addNotesBtn">Add Notes</button>

  <!-- popup -->
  <div id="addNotesPopup" class="popup-backdrop" role="dialog" aria-hidden="true">
    <div class="popup-box" role="document">
      <button id="closeNotesBtn" class="close-btn" aria-label="Close">×</button>
      <h3>New Note</h3>
      <input type="text" placeholder="Title" style="width:100%;padding:8px;margin-bottom:8px;" />
      <textarea placeholder="Type note..." style="width:100%;padding:8px;" rows="5"></textarea>
      <div style="margin-top:10px;text-align:right;">
        <button id="saveNote" style="padding:8px 12px;">Save</button>
      </div>
    </div>
  </div>

  <script>
    // Quick debug log so we know script ran
    console.log("popup script loaded");

    const openBtn = document.getElementById("addNotesBtn");
    const popup = document.getElementById("addNotesPopup");
    const closeBtn = document.getElementById("closeNotesBtn");

    // defensive check
    if (!openBtn || !popup || !closeBtn) {
      console.error("Required elements not found:", { openBtn, popup, closeBtn });
    } else {
      function openPopup() {
        popup.classList.add("open");
        popup.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden"; // prevent background scroll
        // focus the close button for accessibility
        closeBtn.focus();
      }

      function closePopup() {
        popup.classList.remove("open");
        popup.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
        openBtn.focus(); // restore focus
      }

      openBtn.addEventListener("click", (e) => {
        openPopup();
      });

      closeBtn.addEventListener("click", (e) => {
        closePopup();
      });

      // close when clicking on backdrop (outside .popup-box)
      popup.addEventListener("click", (e) => {
        if (e.target === popup) closePopup();
      });

      // close on ESC
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && popup.classList.contains("open")) closePopup();
      });
    }
  </script>
</body>
</html>
